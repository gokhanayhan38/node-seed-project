"use strict";

const Cacheholder = require("..");
const assert = require("assert");

describe("cache-holder", function() {
    it("single instance test", function() {
        const key = "key",
            value = {a: 10, b: 10},
            cache = new Cacheholder();

        cache.setToCache(key, value);
        assert.deepEqual(cache.getFromCache(key), value);

        cache.setToCache(key, 10);
        assert.strictEqual(cache.getFromCache(key), 10);
        assert.ok(!cache.isEmpty());

        cache.removeFromCache(key);
        assert.equal(cache.getFromCache(key), null);
        assert.ok(cache.isEmpty());
    });

    it("multiple instances test", function() {
        const key = "key",
            value = {a: 10, b: 10},
            cache1 = new Cacheholder(),
            cache2 = new Cacheholder();

        cache1.setToCache(key, value);
        assert.deepEqual(cache1.getFromCache(key), value);
        assert.equal(cache2.getFromCache(key), null);

        cache2.setToCache(key, 10);
        assert.strictEqual(cache2.getFromCache(key), 10);
        assert.deepEqual(cache1.getFromCache(key), value);

        cache1.removeFromCache(key);
        assert.equal(cache1.getFromCache(key), null);
        assert.strictEqual(cache2.getFromCache(key), 10);
    });
});
